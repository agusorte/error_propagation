%example QR descomposition

function [Q,R]=qr_dis(A)

if nargin<=0
    
    A=[12 -51 4;
        6 167  68;
        -4 24 -41];
    
    A= 1.0e+05 *[0.0058   -0.0052   -0.0009   -4.5624;
        -0.0009    0.0001   -0.0071    0.6767;
        0.0000    0.0000   -0.0000   -0.0010];
    
    K2=[785.484103326273,0,48.3544690352766;
        0,673.902892225872,245.020283641211;
        0,0,1;]
    R2=[0.699222445479103,-0.708592919524953,-0.0947842082697593;
        -0.358763293592952,-0.233116352277882,-0.903850466322274;
        0.618366291859897,0.665997628148747,-0.417217315546327;];
    T2=[-574.885958490292;135.595838857808;-96.7640189728536];
    
    A=K2*[R2 T2];
    
    A = A ./ norm(A(3,1:3));
    E= [0 0 1; 0 1 0; 1 0 0];
    A=A(:,1:3)'*E;
end;



R=A;

%ahora en 2,1

val=sqrt(R(2,1)^2+R(1,1)^2);
c=R(1,1)/val;
s=-R(2,1)/val;

Qz=[c -s 0;
    s c 0;
    0 0 1];

R=Qz*R;
%second 3,1
val=sqrt(R(1,1)^2+R(3,1)^2);
c=R(1,1)/val;
s=R(3,1)/val;

Qy=[c 0 s;
    0 1 0;
    -s 0 c];
    
 R=Qy*R;



%%%%%% first in 3,2

val=sqrt(R(2,2)^2+R(3,2)^2);

c=-R(2,2)/val;
s=R(3,2)/val;

Qx=[1 0 0;
    0 c -s;
    0 s c];

R=Qx*R;



Q=Qx*Qy*Qz;

R=Q*A;



Q=inv(Q);



K= -E*Q'*E;